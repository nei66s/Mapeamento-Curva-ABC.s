@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 224 71.4% 4.1%;
    --card: 0 0% 100%;
    --card-foreground: 224 71.4% 4.1%;
    --popover: 0 0% 100%;
    --popover-foreground: 224 71.4% 4.1%;
    --primary: 24 72% 56%;
    --primary-foreground: 0 0% 100%;
    --secondary: 24 68% 62%;
    --secondary-foreground: 0 0% 18%;
    --muted: 24 40% 95%;
    --muted-foreground: 24 30% 40%;
    --accent: 24 78% 58%;
    --accent-foreground: 0 0% 15%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 220 13% 91%;
    --input: 24 40% 96%;
    --ring: 24 78% 58%;
    --radius: 0.75rem;
    --chart-1: 220 60% 47%;
    --chart-2: 160 50% 47%;
    --chart-3: 30 70% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;
    /* Curve ABC default palette (light theme): A = red, B = yellow, C = green */
    --curve-a: 0 65% 50%;
    --curve-a-foreground: 0 0% 98%;
    --curve-b: 48 88% 52%;
    --curve-b-foreground: 220 12% 12%;
    --curve-c: 142 50% 44%;
    --curve-c-foreground: 0 0% 98%;
  }

  .dark {
    /* default hero foreground follows card foreground */
    --hero-foreground: 224 71.4% 4.1%;
    --background: 224 71.4% 4.1%;
    --foreground: 210 20% 98%;
    --card: 224 71.4% 5.1%;
    --card-foreground: 210 20% 98%;
    --popover: 224 71.4% 4.1%;
    --popover-foreground: 210 20% 98%;
    --primary: 24 100% 58%;
    --primary-foreground: 0 0% 4%;
    --secondary: 28 85% 40%;
    --secondary-foreground: 0 0% 100%;
    --muted: 29 40% 15%;
    --muted-foreground: 0 0% 90%;
    --accent: 28 100% 52%;
    --accent-foreground: 0 0% 10%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 85.7% 97.3%;
    --border: 215 27.9% 16.9%;
    --input: 215 27.9% 16.9%;
    --ring: 210 100% 66%;
  }

  /* Dark-mode curve overrides */
  .dark {
    --curve-a: 0 70% 45%;
    --curve-a-foreground: 210 20% 98%;
    --curve-b: 48 90% 40%;
    --curve-b-foreground: 210 20% 98%;
    --curve-c: 142 56% 36%;
    --curve-c-foreground: 210 20% 98%;
  }
}

/* Hero gradient variables (used by `HeroPanel` via the .hero-gradient class).
   These default to subtle, theme-aware stops and are overridden per color theme. */
:root {
  --hero-from: 210 14% 96%;
  --hero-via: 210 10% 92%;
  --hero-to: 210 6% 88%;
}
.dark {
  --hero-from: 215 36% 10%;
  --hero-via: 215 34% 8%;
  --hero-to: 215 32% 6%;
}

:root[data-theme="seasonal"] {
  --hero-from: 160 40% 95%;
  --hero-via: 170 55% 85%;
  --hero-to: 320 50% 75%;
}
.dark[data-theme="seasonal"] {
  --hero-from: 220 20% 15%;
  --hero-via: 210 20% 18%;
  --hero-to: 200 30% 15%;
}

/* Per-theme hero gradients: these map to softer corporate accents */
[data-theme="blue"] {
  --hero-from: 215 36% 45%;
  --hero-via: 213 30% 40%;
  --hero-to: 210 24% 36%;
}
.dark[data-theme="blue"] {
  --hero-from: 215 36% 38%;
  --hero-via: 213 30% 34%;
  --hero-to: 210 24% 30%;
}

[data-theme="green"] {
  --hero-from: 150 32% 42%;
  --hero-via: 150 28% 38%;
  --hero-to: 140 24% 34%;
}
.dark[data-theme="green"] {
  --hero-from: 150 32% 36%;
  --hero-via: 150 28% 32%;
  --hero-to: 140 24% 28%;
}

[data-theme="purple"] {
  --hero-from: 260 30% 46%;
  --hero-via: 265 28% 42%;
  --hero-to: 250 22% 36%;
}
.dark[data-theme="purple"] {
  --hero-from: 260 30% 38%;
  --hero-via: 265 24% 34%;
  --hero-to: 250 20% 30%;
}

[data-theme="orange"] {
  --hero-from: 28 48% 48%;
  --hero-via: 28 44% 44%;
  --hero-to: 28 36% 38%;
}
.dark[data-theme="orange"] {
  --hero-from: 28 46% 40%;
  --hero-via: 28 42% 36%;
  --hero-to: 28 36% 30%;
}

/* Utility class that builds a gradient using the hero variables. Use this on
   panels that should reflect the chosen color theme. */
.hero-gradient {
  background-image: linear-gradient(135deg, hsl(var(--hero-from)) 0%, hsl(var(--hero-via)) 50%, hsl(var(--hero-to)) 100%);
  color: hsl(var(--hero-foreground));
}

/* Color themes (light + dark-aware overrides). Each theme overrides the
   semantic color variables (primary, secondary, accent and chart colors).
   The app stores the selected color in `localStorage` and sets
   `document.documentElement.dataset.theme = '<theme-id>'` to switch. */

[data-theme="blue"] {
  --primary: 215 36% 45%;
  --accent: 213 40% 50%;
  --secondary: 210 14% 96%;
  --chart-1: 215 34% 45%;
  --chart-2: 200 28% 45%;
  --chart-3: 30 80% 55%;
  --chart-4: 260 30% 60%;
  --chart-5: 330 30% 55%;
  --hero-foreground: 215 20% 12%;
}
.dark[data-theme="blue"] {
  --primary: 215 36% 38%;
  --accent: 213 30% 44%;
  --chart-1: 215 36% 40%;
  --chart-2: 200 28% 42%;
  --chart-3: 30 80% 55%;
  --chart-4: 260 30% 48%;
  --chart-5: 330 30% 48%;
  --hero-foreground: 210 20% 98%;
}

/* Ensure soft themes also override semantic surface tokens so panels/cards follow the
   chosen palette and maintain readable foregrounds. This mirrors the vivid overrides
   but keeps slightly softer contrast for the lighter tone. */
[data-theme="blue"] {
  --card: 215 36% 97%;
  --card-foreground: 215 20% 12%;
  --muted: 215 36% 98%;
  --muted-foreground: 215 22% 20%;
  --border: 215 36% 90%;
}
.dark[data-theme="blue"] {
  --card: 215 36% 12%;
  --card-foreground: 210 20% 98%;
  --muted: 215 30% 8%;
  --muted-foreground: 210 20% 90%;
  --border: 215 36% 24%;
}

[data-theme="green"] {
  --primary: 150 32% 42%;
  --accent: 150 28% 45%;
  --secondary: 145 22% 94%;
  --chart-1: 150 32% 42%;
  --chart-2: 190 28% 45%;
  --chart-3: 34 60% 50%;
  --chart-4: 220 30% 55%;
  --chart-5: 10 55% 50%;
  --hero-foreground: 142 28% 12%;
}
.dark[data-theme="green"] {
  --primary: 150 32% 36%;
  --accent: 150 26% 40%;
  --chart-1: 150 32% 38%;
  --chart-2: 190 28% 42%;
  --hero-foreground: 150 24% 96%;
}

/* Soft theme surface tokens for green */
[data-theme="green"] {
  --card: 142 60% 96%;
  --card-foreground: 142 28% 12%;
  --muted: 142 60% 98%;
  --muted-foreground: 142 30% 20%;
  --border: 142 60% 90%;
}
.dark[data-theme="green"] {
  --card: 142 60% 12%;
  --card-foreground: 150 24% 96%;
  --muted: 142 50% 10%;
  --muted-foreground: 150 24% 90%;
  --border: 142 60% 26%;
}

[data-theme="purple"] {
  --primary: 260 30% 46%;
  --accent: 265 28% 48%;
  --secondary: 268 18% 92%;
  --chart-1: 260 30% 46%;
  --chart-2: 220 26% 45%;
  --chart-3: 30 80% 55%;
  --chart-4: 290 28% 55%;
  --chart-5: 330 30% 50%;
  --hero-foreground: 270 30% 14%;
}
.dark[data-theme="purple"] {
  --primary: 260 30% 38%;
  --accent: 265 24% 42%;
  --hero-foreground: 265 24% 96%;
}

/* Soft theme surface tokens for purple */
[data-theme="purple"] {
  --card: 270 60% 96%;
  --card-foreground: 270 30% 14%;
  --muted: 270 60% 98%;
  --muted-foreground: 270 32% 22%;
  --border: 270 60% 90%;
}
.dark[data-theme="purple"] {
  --card: 270 56% 12%;
  --card-foreground: 265 24% 96%;
  --muted: 270 50% 10%;
  --muted-foreground: 265 24% 90%;
  --border: 270 56% 26%;
}

[data-theme="orange"] {
  --primary: 28 44% 52%;
  --accent: 28 44% 52%;
  --secondary: 30 20% 94%;
  --chart-1: 28 44% 50%;
  --chart-2: 200 28% 45%;
  --chart-3: 30 80% 55%;
  --chart-4: 30 28% 60%;
  --chart-5: 340 30% 50%;
}
.dark[data-theme="orange"] {
  --primary: 28 42% 42%;
  --accent: 28 40% 44%;
}

/* Soft theme surface tokens for orange */
[data-theme="orange"] {
  --card: 25 90% 96%;
  --card-foreground: 25 40% 12%;
  --muted: 25 90% 98%;
  --muted-foreground: 25 50% 20%;
  --border: 25 90% 90%;
}
.dark[data-theme="orange"] {
  --card: 25 86% 14%;
  --card-foreground: 24 42% 96%;
  --muted: 25 80% 12%;
  --muted-foreground: 24 42% 90%;
  --border: 25 86% 26%;
}

/* small utility swatches used by theme picker */
.swatch-blue { background: hsl(215 36% 45%); }
.swatch-green { background: hsl(150 32% 42%); }
.swatch-purple { background: hsl(260 30% 46%); }
.swatch-orange { background: hsl(28 48% 48%); }

/* Soft/vivid aliases: keep existing soft names as default, add vivid variants */
.swatch-blue-soft { background: hsl(215 36% 45%); }
.swatch-green-soft { background: hsl(150 32% 42%); }
.swatch-purple-soft { background: hsl(260 30% 46%); }
.swatch-orange-soft { background: hsl(28 48% 48%); }

.swatch-blue-vivid { background: hsl(222 90% 56%); }
.swatch-green-vivid { background: hsl(142 60% 40%); }
.swatch-purple-vivid { background: hsl(270 60% 48%); }
.swatch-orange-vivid { background: hsl(25 90% 52%); }
.swatch-seasonal-soft,
.swatch-seasonal-vivid {
  background: linear-gradient(135deg, hsl(330 80% 80%) 0%, hsl(40 90% 85%) 50%, hsl(150 60% 90%) 100%);
}

/* Vivid theme color blocks (light + dark variations). These provide the
   legacy / non-soft palettes the user requested. */
[data-theme="blue-vivid"] {
  --primary: 222 90% 56%;
  --accent: 210 100% 60%;
  --secondary: 210 16% 96%;
  --chart-1: 222 75% 45%;
  --chart-2: 200 60% 45%;
  --chart-3: 30 80% 55%;
  --chart-4: 280 65% 60%;
  --chart-5: 340 75% 55%;
}
.dark[data-theme="blue-vivid"] {
  --primary: 222 90% 52%;
  --accent: 210 90% 54%;
  --chart-1: 222 70% 44%;
}

/* Hero gradient overrides for vivid themes so hero-gradient reflects vivid palettes */
[data-theme="blue-vivid"] {
  --hero-from: 222 90% 56%;
  --hero-via: 215 36% 45%;
  --hero-to: 210 24% 36%;
}
.dark[data-theme="blue-vivid"] {
  --hero-from: 222 90% 52%;
  --hero-via: 213 30% 34%;
  --hero-to: 210 24% 30%;
}

[data-theme="green-vivid"] {
  --primary: 142 60% 40%;
  --accent: 150 80% 45%;
  --secondary: 145 22% 96%;
  --chart-1: 142 60% 40%;
  --chart-2: 190 45% 45%;
}
.dark[data-theme="green-vivid"] {
  --primary: 142 56% 36%;
  --accent: 150 72% 40%;
}

/* Hero gradient overrides for green vivid */
[data-theme="green-vivid"] {
  --hero-from: 142 60% 40%;
  --hero-via: 150 80% 45%;
  --hero-to: 145 22% 96%;
}
.dark[data-theme="green-vivid"] {
  --hero-from: 142 56% 36%;
  --hero-via: 150 72% 40%;
  --hero-to: 142 50% 10%;
}

[data-theme="purple-vivid"] {
  --primary: 270 60% 48%;
  --accent: 285 75% 55%;
  --secondary: 268 18% 92%;
  --chart-1: 270 60% 48%;
}
.dark[data-theme="purple-vivid"] {
  --primary: 270 56% 40%;
  --accent: 285 68% 48%;
}

/* Hero gradient overrides for purple vivid */
[data-theme="purple-vivid"] {
  --hero-from: 270 60% 48%;
  --hero-via: 285 75% 55%;
  --hero-to: 268 18% 92%;
}
.dark[data-theme="purple-vivid"] {
  --hero-from: 270 56% 40%;
  --hero-via: 285 68% 48%;
  --hero-to: 270 50% 10%;
}

[data-theme="orange-vivid"] {
  --primary: 25 78% 50%;
  --accent: 24 82% 52%;
  --secondary: 30 20% 94%;
  --chart-1: 25 90% 52%;
}
.dark[data-theme="orange-vivid"] {
  --primary: 25 76% 46%;
  --accent: 24 78% 48%;
}

/* Hero gradient overrides for orange vivid */
[data-theme="orange-vivid"] {
  --hero-from: 25 90% 52%;
  --hero-via: 24 95% 54%;
  --hero-foreground: 25 40% 12%;
  --hero-to: 30 20% 94%;
}
.dark[data-theme="orange-vivid"] {
  --hero-from: 25 86% 46%;
  --hero-foreground: 24 42% 96%;
  --hero-via: 24 88% 48%;
  --hero-to: 25 80% 12%;
}

/* Ensure vivid themes also override semantic surface tokens so containers follow the chosen palette */
[data-theme="blue-vivid"] {
  --card: 215 36% 97%;
  --card-foreground: 215 20% 12%;
  --muted: 215 36% 98%;
  --muted-foreground: 215 22% 20%;
  --border: 215 36% 90%;
}
.dark[data-theme="blue-vivid"] {
  --card: 215 36% 12%;
  --card-foreground: 210 20% 98%;
  --muted: 215 30% 8%;
  --muted-foreground: 210 20% 90%;
  --border: 215 36% 24%;
}

[data-theme="green-vivid"] {
  --card: 142 60% 96%;
  --card-foreground: 142 28% 12%;
  --muted: 142 60% 98%;
  --muted-foreground: 142 30% 20%;
  --border: 142 60% 90%;
}
.dark[data-theme="green-vivid"] {
  --card: 142 60% 12%;
  --card-foreground: 150 24% 96%;
  --muted: 142 50% 10%;
  --muted-foreground: 150 24% 90%;
  --border: 142 60% 26%;
}

[data-theme="purple-vivid"] {
  --card: 270 60% 96%;
  --card-foreground: 270 30% 14%;
  --muted: 270 60% 98%;
  --muted-foreground: 270 32% 22%;
  --border: 270 60% 90%;
}
.dark[data-theme="purple-vivid"] {
  --card: 270 56% 12%;
  --card-foreground: 265 24% 96%;
  --muted: 270 50% 10%;
  --muted-foreground: 265 24% 90%;
  --border: 270 56% 26%;
}

[data-theme="orange-vivid"] {
  --card: 25 90% 96%;
  --card-foreground: 25 40% 12%;
  --muted: 25 90% 98%;
  --muted-foreground: 25 50% 20%;
  --border: 25 90% 90%;
}
.dark[data-theme="orange-vivid"] {
  --card: 25 86% 14%;
  --card-foreground: 24 42% 96%;
  --muted: 25 80% 12%;
  --muted-foreground: 24 42% 90%;
  --border: 25 86% 26%;
}

.theme-swatch-btn {
  border-color: transparent;
}
.theme-swatch-btn.active {
  border-color: hsl(var(--ring));
}

/* Utility classes to apply Curve A/B/C as panel backgrounds with readable foregrounds */
.curve-a {
  background-color: hsl(var(--curve-a) / 0.85);
  color: hsl(var(--curve-a-foreground));
}
.curve-b {
  background-color: hsl(var(--curve-b) / 0.85);
  color: hsl(var(--curve-b-foreground));
}
.curve-c {
  background-color: hsl(var(--curve-c) / 0.85);
  color: hsl(var(--curve-c-foreground));
}

.curve-a > *,
.curve-b > *,
.curve-c > * {
  /* ensure child text/icons inherit the readable foreground */
  color: inherit;
}

@layer base {
  /* Removed global border on all elements â€” this caused heavy visual noise
     across the app. Borders should be applied to semantic components only. */
  body {
    @apply bg-background text-foreground;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Small utility helpers for consistent UI surfaces and elevation. Use
     these deliberately on components instead of applying borders to * */
  .card {
    @apply rounded-lg border border-border bg-card p-4 shadow-sm;
  }

  /* Generic panel helper to replace repeated 'rounded-lg border p-4' patterns
     across the app. Use `panel` on simple containers; use `card` for semantic
     card components that require text foreground and default padding. */
  .panel {
    @apply rounded-lg border border-border p-4 bg-card elevation-1;
  }

  .elevation-0 { box-shadow: none; }
  .elevation-1 { @apply shadow-sm; }
  .elevation-2 { @apply shadow-md; }
  .elevation-3 { @apply shadow-lg; }

  /* Use a softened hero style when you want a toned panel instead of a full
     vivid gradient. Apply `hero-soft` alongside or instead of `hero-gradient`. */
  .hero-soft { opacity: 0.95; filter: saturate(0.95); }
}

/* PDF / A4 helper styles used for html2canvas capture */
.pdf-a4 {
  width: 210mm;
  min-height: 297mm;
  background: #ffffff;
  color: #000000;
  box-sizing: border-box;
  padding: 2rem;
  font-family: serif;
}

.pdf-a4 header,
.pdf-a4 section,
.pdf-a4 footer {
  break-inside: avoid;
}

/* helper to render element off-screen for html2canvas capture without inline styles */
.printable-offscreen {
  position: absolute;
  left: -9999px;
  top: -9999px;
  width: 210mm; /* ensure offscreen copy has same width */
}

/* Each visual PDF page for print preview */
.pdf-page {
  width: 210mm;
  height: 297mm;
  box-sizing: border-box;
  padding: 20mm 16mm;
  background: #fff;
  color: #000;
  page-break-after: always;
  overflow: hidden;
}

.pdf-a4 .pdf-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 2px solid #1f2937;
  padding-bottom: 8px;
  margin-bottom: 8px;
}

.pdf-a4 h1 { font-size: 18px; margin: 0; }
.pdf-a4 h2 { font-size: 13px; margin: 0 0 6px 0; }
.pdf-a4 p { font-size: 11px; margin: 0 0 6px 0; }
.pdf-a4 .label { font-weight: 600; color: #374151; }
.pdf-a4 .value { font-weight: 400; color: #111827; }

.pdf-footer { position: absolute; bottom: 16mm; left: 0; right: 0; text-align: center; font-size: 10px; color: #6b7280; }

/* Map locate control and user marker styles */
.leaflet-control-locate { display: inline-block; }
.leaflet-control-locate button { display: inline-flex; align-items: center; justify-content: center; width: 36px; height: 36px; border: none; background: white; border-radius: 8px; cursor: pointer; }
.leaflet-control-locate button:hover { box-shadow: 0 4px 10px rgba(0,0,0,0.12); }
.leaflet-control-locate button.locate-active { background: #16a34a; color: white; }

/* Pulsing user marker - applies to Leaflet circleMarker SVG path via className */
.user-circle { animation: pulse 1.8s infinite ease-out; }
@keyframes pulse {
  0% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.6); opacity: 0.6; }
  100% { transform: scale(1); opacity: 1; }
}

/* professional pin icon for user location (divIcon) */
.user-pin-wrapper { display: inline-block; position: relative; width: 36px; height: 36px; line-height: 0; }
/* Position the visual pin so its tip is at the bottom center of the wrapper
  (this makes the Leaflet iconAnchor [18,36] align with the pin tip). */
.user-pin { position: absolute; left: 50%; bottom: 0; transform: translateX(-50%); }
.user-pin .pin-svg { width: 28px; height: 28px; display: block; }
/* Pulse should be centered on the tip of the pin (bottom center). We position
  the pulse's center at the bottom edge of the wrapper by using bottom: 0 and
  translateY(50%), so the pulse's center aligns with the pin tip. */
.user-pin-pulse { display: none; }

.mobile-bottom-nav {
  padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 0.4rem);
}
