@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 210 25% 97%;
    --foreground: 214 16% 18%;
    --card: 0 0% 100%;
    --card-foreground: 214 16% 18%;
    --popover: 0 0% 100%;
    --popover-foreground: 214 16% 18%;
    --primary: 222 62% 58%;
    --primary-foreground: 0 0% 100%;
    --secondary: 205 20% 55%;
    --secondary-foreground: 0 0% 100%;
    --muted: 210 18% 88%;
    --muted-foreground: 214 18% 38%;
    --accent: 212 80% 60%;
    --accent-foreground: 214 18% 18%;
    --warning: 35 95% 60%;
    --warning-foreground: 0 0% 100%;
    --destructive: 0 70% 50%;
    --destructive-foreground: 0 0% 100%;
    --border: 210 12% 86%;
    --input: 210 10% 96%;
    --ring: 210 45% 90%;
    --radius-sm: 0.375rem;
    --radius-md: 0.5rem;
    --radius-lg: 0.75rem;
    --space-xs: 0.25rem;
    --space-sm: 0.5rem;
    --space-md: 0.75rem;
    --space-lg: 1rem;
    --space-xl: 1.5rem;
    --space-xxl: 2rem;
    --curve-a: 210 20% 65%;
    --curve-a-foreground: 0 0% 96%;
    --curve-b: 42 68% 65%;
    --curve-b-foreground: 0 0% 15%;
    --curve-c: 140 30% 45%;
    --curve-c-foreground: 0 0% 96%;
    --color-background: hsl(var(--background));
    --color-foreground: hsl(var(--foreground));
    --surface-background: hsl(var(--card));
    --surface-foreground: hsl(var(--card-foreground));
    --surface-border: hsl(var(--border));
    --transition-gentle: 0.2s ease;
    --transition-smooth: 0.3s ease;
  }

  .dark {
    --background: 218 18% 9%;
    --foreground: 214 16% 96%;
    --card: 220 18% 16%;
    --card-foreground: 214 16% 96%;
    --popover: 220 18% 16%;
    --popover-foreground: 214 16% 96%;
    --primary: 221 60% 62%;
    --primary-foreground: 0 0% 100%;
    --secondary: 210 15% 68%;
    --secondary-foreground: 0 0% 100%;
    --muted: 214 16% 30%;
    --muted-foreground: 214 16% 92%;
    --accent: 212 70% 62%;
    --accent-foreground: 214 16% 96%;
    --warning: 35 95% 60%;
    --warning-foreground: 0 0% 100%;
    --destructive: 0 70% 50%;
    --destructive-foreground: 0 0% 100%;
    --border: 218 25% 22%;
    --input: 220 18% 20%;
    --ring: 216 56% 64%;
    --color-background: hsl(var(--background));
    --color-foreground: hsl(var(--foreground));
    --surface-background: hsl(var(--card));
    --surface-foreground: hsl(var(--card-foreground));
    --surface-border: hsl(var(--border));
    --transition-gentle: 0.2s ease;
    --transition-smooth: 0.3s ease;
    --curve-a: 210 20% 60%;
    --curve-a-foreground: 0 0% 96%;
    --curve-b: 39 60% 58%;
    --curve-b-foreground: 0 0% 15%;
    --curve-c: 146 36% 42%;
    --curve-c-foreground: 0 0% 96%;
  }

  html,
  body,
  #__next {
    width: 100%;
    height: 100%;
  }

  body {
    @apply text-foreground antialiased min-h-screen;
    background-color: transparent;
    background-image: none;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    margin: 0;
    padding: 0;
  }

  .card,
  .surface-card {
    border: 1px solid var(--surface-border);
    background-color: var(--surface-background);
    color: var(--surface-foreground);
    border-radius: var(--radius-md);
    padding: var(--space-lg);
  }

  .panel,
  .surface-block {
    border: 1px solid var(--surface-border);
    border-radius: var(--radius-md);
    background-color: var(--surface-background);
    color: var(--surface-foreground);
    padding: var(--space-lg);
  }

  .surface-highlight {
    border: 1px solid var(--surface-border);
    background-color: var(--surface-background);
    padding: var(--space-md);
    border-radius: var(--radius-sm);
    transition: background-color var(--transition-gentle), border-color var(--transition-gentle), transform var(--transition-gentle);
  }

  .surface-control {
    border: 1px solid var(--surface-border);
    border-radius: var(--radius-md);
    background-color: var(--surface-background);
    color: var(--surface-foreground);
    padding: var(--space-sm) var(--space-md);
    font-size: 0.95rem;
    font-weight: 500;
    transition: border-color var(--transition-gentle), background-color var(--transition-gentle);
  }

  .surface-block-muted {
    border-style: dashed;
    opacity: 0.85;
  }

  .surface-control:focus-visible {
    outline: 2px solid var(--primary);
    outline-offset: 2px;
  }

  .surface-dropdown {
    border: 1px solid var(--surface-border);
    border-radius: var(--radius-sm);
    background-color: var(--surface-background);
    transition: border-color var(--transition-gentle), background-color var(--transition-gentle);
  }

  .btn-variant-default {
    background-color: hsl(var(--primary));
    color: hsl(var(--primary-foreground));
    border-radius: var(--radius-md);
    border: 1px solid transparent;
  }

  .btn-variant-default:hover {
    background-color: hsl(var(--primary) / 0.9);
  }

  .btn-variant-secondary {
    background-color: hsl(var(--secondary));
    color: hsl(var(--secondary-foreground));
    border-radius: var(--radius-md);
    border: 1px solid transparent;
  }

  .btn-variant-secondary:hover {
    background-color: hsl(var(--secondary) / 0.9);
  }

  .btn-variant-destructive {
    background-color: hsl(var(--destructive));
    color: hsl(var(--destructive-foreground));
    border-radius: var(--radius-md);
    border: 1px solid transparent;
  }

  .btn-variant-destructive:hover {
    background-color: hsl(var(--destructive) / 0.9);
  }

  .btn-variant-outline {
    background-color: transparent;
    color: var(--color-foreground);
    border: 1px solid var(--surface-border);
    border-radius: var(--radius-md);
  }

  .btn-variant-outline:hover {
    border-color: var(--primary);
    color: hsl(var(--primary-foreground));
  }

  .btn-variant-ghost {
    background-color: transparent;
    color: var(--color-foreground);
    border-color: transparent;
  }

  .btn-variant-link {
    background-color: transparent;
    color: hsl(var(--primary));
    border-color: transparent;
    padding: 0;
  }

  .elevation-0,
  .elevation-1,
  .elevation-2,
  .elevation-3 {
    box-shadow: none;
  }

  .hero-soft {
    opacity: 1;
    filter: none;
  }

  .curve-a {
    background-color: hsl(var(--curve-a) / 0.85);
    color: hsl(var(--curve-a-foreground));
  }
  .curve-b {
    background-color: hsl(var(--curve-b) / 0.85);
    color: hsl(var(--curve-b-foreground));
  }
  .curve-c {
    background-color: hsl(var(--curve-c) / 0.85);
    color: hsl(var(--curve-c-foreground));
  }

  .curve-a > *,
  .curve-b > *,
  .curve-c > * {
    color: inherit;
  }

  .flat-transition {
    transition: background-color var(--transition-gentle), border-color var(--transition-gentle), color var(--transition-gentle);
  }
}

@layer components {
  .page-shell {
    position: relative;
    overflow: hidden;
    border-radius: var(--radius-md);
    border-width: 1px;
    border-style: solid;
    border-color: var(--surface-border);
    background-color: var(--surface-background);
    padding: var(--space-xl);
  }

  .page-shell > * + * {
    margin-top: var(--space-lg);
  }

  #login-form {
    border: 0;
    box-shadow: none;
  }

  #login-form .surface-control {
    border: none;
    box-shadow: none;
    background-color: rgba(15, 23, 42, 0.65);
  }

  #login-form input[type='checkbox'] {
    border: none;
    box-shadow: none;
  }
}

/* PDF / A4 helper styles used for html2canvas capture */
.pdf-a4 {
  width: 210mm;
  min-height: 297mm;
  background: #ffffff;
  color: #000000;
  box-sizing: border-box;
  padding: 2rem;
  font-family: serif;
}

.pdf-a4 header,
.pdf-a4 section,
.pdf-a4 footer {
  break-inside: avoid;
}

/* helper to render element off-screen for html2canvas capture without inline styles */
.printable-offscreen {
  position: absolute;
  left: -9999px;
  top: -9999px;
  width: 210mm; /* ensure offscreen copy has same width */
}

/* Each visual PDF page for print preview */
.pdf-page {
  width: 210mm;
  height: 297mm;
  box-sizing: border-box;
  padding: 20mm 16mm;
  background: #fff;
  color: #000;
  page-break-after: always;
  overflow: hidden;
}

.pdf-a4 .pdf-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 2px solid #1f2937;
  padding-bottom: 8px;
  margin-bottom: 8px;
}

.pdf-a4 h1 { font-size: 18px; margin: 0; }
.pdf-a4 h2 { font-size: 13px; margin: 0 0 6px 0; }
.pdf-a4 p { font-size: 11px; margin: 0 0 6px 0; }
.pdf-a4 .label { font-weight: 600; color: #374151; }
.pdf-a4 .value { font-weight: 400; color: #111827; }

.pdf-footer { position: absolute; bottom: 16mm; left: 0; right: 0; text-align: center; font-size: 10px; color: #6b7280; }

/* Map locate control and user marker styles */
.leaflet-control-locate { display: inline-block; }
.leaflet-control-locate button { display: inline-flex; align-items: center; justify-content: center; width: 36px; height: 36px; border: none; background: white; border-radius: 8px; cursor: pointer; }
.leaflet-control-locate button:hover { box-shadow: 0 4px 10px rgba(0,0,0,0.12); }
.leaflet-control-locate button.locate-active { background: #16a34a; color: white; }

/* Pulsing user marker - applies to Leaflet circleMarker SVG path via className */
.user-circle { animation: pulse 1.8s infinite ease-out; }
@keyframes pulse {
  0% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.6); opacity: 0.6; }
  100% { transform: scale(1); opacity: 1; }
}

/* professional pin icon for user location (divIcon) */
.user-pin-wrapper { display: inline-block; position: relative; width: 36px; height: 36px; line-height: 0; }
/* Position the visual pin so its tip is at the bottom center of the wrapper
  (this makes the Leaflet iconAnchor [18,36] align with the pin tip). */
.user-pin { position: absolute; left: 50%; bottom: 0; transform: translateX(-50%); }
.user-pin .pin-svg { width: 28px; height: 28px; display: block; }
/* Pulse should be centered on the tip of the pin (bottom center). We position
  the pulse's center at the bottom edge of the wrapper by using bottom: 0 and
  translateY(50%), so the pulse's center aligns with the pin tip. */
.user-pin-pulse { display: none; }

.mobile-bottom-nav {
  padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 0.4rem);
}
